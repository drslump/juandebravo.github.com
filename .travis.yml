language: ruby

env:
  global:
    secure: CNw3WewLv0XHRnbeXuVMEQIMCDN3sPaZqXlmDiFi6jCYITnSnet9t86/4Ul6i5Cf/QgYgkQikizwwvunIf6MQHkV7baaLPIdbwItRdmE1SbCc2WGqnTFlih55guReJo7Q03yy6d1fgrHzSYE6hBqZQDZGL4NWbCkaRgTgiAyIpw=

rvm: 1.9.3

install:
    - bundle install
    - rake emoji

before_script:
    - rake tags
    - git config --global user.email "juandebravo@gmail.com"
    - git config --global user.name "Juan de Bravo"

script:
    - git checkout develop
    - jekyll --no-server --no-safe
    - rm -rf tag
    - git checkout master
    - rm -rf 2012 2013 2014 gfx css tag js
    - cp -r _site/* .
    - git add 2012 2013 2014 tag
    - git commit -am "Added new post"

after_success:
    - git config credential.helper "store --file=.git/credentials"
    - git remote set-url origin https://github.com/juandebravo/juandebravo.github.com.git
    - echo "https://${GH_TOKEN}:@github.com" > .git/credentials
    - git push origin master
